<div class="compact-card" [class.expanded]="isExpanded">
  <!-- âœ… HERO IMAGE HEADER (Image-first design) -->
  <div class="card-hero" [ngStyle]="getCardBackgroundStyle()">
    <!-- Score badge overlay (top-right corner of image) -->
    <div class="hero-score" [ngClass]="getScoreColor()">
      <span class="score-value">{{ recommendation.overallRecommendationScore }}</span>
      <span class="score-label">Match</span>
    </div>
  </div>

  <!-- Header: Name + Score -->
  <div class="card-header" (click)="toggleExpanded()" [class.clickable]="!isExpanded">
    <div class="name-section">
      <h3 class="destination-name">{{ recommendation.destination.state }}</h3>
      <p class="destination-location">{{ recommendation.destination.country }}</p>
    </div>
  </div>

  <!-- Badges: Max 2 categories (hidden when expanded) -->
  <div class="badges-section" *ngIf="topBadges.length > 0 && !isExpanded">
    <span *ngFor="let badge of topBadges" [ngClass]="['badge', getBadgeClass(badge)]">
      {{ badge }}
    </span>
  </div>

  <!-- EXPANSION SECTION: Preview Content (optional, header click) -->
  <div class="expansion-content" *ngIf="isExpanded">
    <!-- Step Header -->
    <div class="expansion-header">
      <h4>âœ¨ Why Visit {{ recommendation.destination.state }}?</h4>
      <p class="expansion-subtitle">Perfect for: {{ topBadges.length > 0 ? topBadges.join(', ') : 'exploration' }}</p>
    </div>

    <!-- Day Selection Note -->
    <div class="day-selection-hint">
      <p>ðŸ’¡ <strong>Choose trip length in the drawer</strong></p>
      <p style="font-size: 12px; color: #6b7280; margin: 0;">
        Select 3â€“7 days after opening to see customized itinerary
      </p>
    </div>

    <!-- Quick Prep Section -->
    <div class="quick-prep">
      <h5>ðŸ“¦ Quick Prep</h5>
      <button class="essentials-link" (click)="onEssentialsClick()">
        ðŸ§³ Travel Essentials (Amazon)

      </button>
    </div>
  </div>

  <!-- CTA Button -->
  <button 
    class="cta-button" 
    [class.expanded-cta]="isExpanded"
    [class.disabled]="isCtaDisabled()"
    (click)="onCtaClick()"
    [disabled]="isCtaDisabled()">
    {{ getCtaLabel() }}
  </button>
</div>
